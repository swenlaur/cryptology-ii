\documentclass{article}
\usepackage{amssymb}
\usepackage{crysymb}
\usepackage[paperwidth=14cm,paperheight=10cm]{geometry}
\usepackage{pstricks}
\usepackage{pst-node}
\usepackage{colortbl}
%\usepackage[table]{xcolor}

\begin{document}
\noindent
\thispagestyle{empty}
\enlargethispage{1cm}
\begin{pspicture}(-4,-3.0)(4,4.0)
\rput(0,2.5){
	\psframe[fillstyle=solid,fillcolor=red,linecolor=black,framearc=0.1](0,0)(1.5,1.5)
	\rput(0.75,0.75){$\AD$}
	\pnode(0.0,0.75){A0}
	\pnode(1.5,0.75){A1}
}

\rput(-0.25,0.5)
{
	\psframe[fillstyle=solid,fillcolor=olive!20,linecolor=black,framearc=0.1,linestyle=dotted](0,0)(2.0,1.0)
	\rput(1.00,0.50){$\SK\gets\GEN$}
	\pnode(0.0,0.5){G0}
	\pnode(2.0,0.5){G1}
}

\rput(-5.0,0.5)
{
	\psframe[fillstyle=solid,fillcolor=teal!20,linecolor=black,framearc=0.1, linestyle=dotted](0,0)(2.0,1.0)
	\rput(1.0,0.50){$\mathsf{Auth\text{-}Enc}$}
	\pnode(0.0,0.5){E0}
	\pnode(2.0,0.5){E1}
	\pnode(1.0,1.0){E2}
	\pnode(0.8,0.0){E3}
	\pnode(1.2,0.0){E4}
}

\rput(+4.5,0.5)
{
	\psframe[fillstyle=solid,fillcolor=teal!20,linecolor=black,framearc=0.1,linestyle=dotted](0,0)(2.0,1.0)
	\rput(1.00,0.50){$\mathsf{Auth\text{-}Dec}$}
	\pnode(0.0,0.5){D0}
	\pnode(2.0,0.5){D1}
	\pnode(1.0,1.0){D2}
	\pnode(1.0,0.0){D3}
}

\rput(-0.25,-4.0)
{
	\psframe[fillstyle=solid,fillcolor=teal!50,linecolor=black,framearc=0.1](0,0)(2.0,1.0)
	\rput(1.00,0.50){$h(\cdot, k)$}
	\pnode(0.0,0.3){H0}
	\pnode(2.0,0.3){H1}
	\pnode(0.0,0.7){H2}
	\pnode(2.0,0.7){H3}
}


\ncline[arrowsize=6pt]{->}{G0}{E1}
\bput{:D}{$\SK$}
\ncline[arrowsize=6pt]{->}{G1}{D0}
\aput{:U}{$\SK$}
\ncangle[angleA=180,angleB=90,arrowsize=6pt]{->}{A0}{E2}
\rput(-1.95,3.5){$m_1,\ldots,m_q$}
\ncangle[angleA=180,angleB=90,arrowsize=6pt]{->}{A1}{D2}
\rput(+3.5,3.5){$(\hat{c}_1,\hat{t}_1),\ldots,(\hat{c}_n,\hat{t}_n)$}

\rput(0.70,-1.2)
{
	\begin{tabular}{|c|c|c|}
	\hline
	$m_1$& $t_1$ & $c_1$\\
	$m_2$& $t_2$ & $c_2$\\
	$\vdots$& $\vdots$ & $\vdots$ \\
	$m_{\ell}$& $t_\ell$ & $c_\ell$\\
	\hline
	\end{tabular}
	\pnode(-2.45,-0.15){DB1}
	\pnode(+0.05,-0.15){DB2}
	
}

\ncangle[angleA=-90,angleB=180,arrowsize=6pt]{->}{E3}{H0}
\bput{:U}{$c_i$}
\ncangle[angleA=180, angleB=-90, arm=1cm,arrowsize=6pt]{->}{H2}{E4}
\rput(-2.1,-2.9){$t_i\gets h(c_i,k)$}
\ncangle[angleA=-90, angleB=180, arm=1cm,arrowsize=6pt]{->}{E4}{DB1}
\ncangle[angleA=-90, angleB=180, arm=1cm,arrowsize=6pt]{->}{D4}{DB3}
\ncangle[angleA=-90,angleB=0,arrowsize=6pt]{->}{D3}{DB2}
\rput(-2.2,-1.15){$m_i,t_i,c_i$}

\rput{90}(-4.5,-1.5){$c_i\gets\ENC_\PK(m_i)$}


\rput(3.9,-1.15){$\exists i\,\forall j: \hat{m}_i\neq m_j$?}


\end{pspicture}

\end{document}
